<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Семинар такой-то!</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
            background: linear-gradient(to bottom, #87CEEB, #1E90FF);
            /* Новый фон с школьной тематикой */
            background-image: url('school-bg.jpg'); /* Замените на свою ссылку */
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
        }
        /* Затемнение фона для лучшей читаемости */
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.7);
            z-index: -1;
        }
        .traffic-light {
            display: inline-block;
            background: #333;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        .light {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        #red { background: #ff0000; }
        #yellow { background: #ffff00; }
        #green { background: #00ff00; }
        .counter {
            font-size: 24px;
            margin: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            display: inline-block;
        }
        #reset-btn {
            padding: 12px 25px;
            font-size: 18px;
            background: #333;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        /* Стиль для заголовка */
        h1 {
            background: rgba(255, 255, 255, 0.8);
            display: inline-block;
            padding: 10px 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <h1>Многопользовательский светофор</h1>
    
    <div class="traffic-light">
        <div id="red" class="light" onclick="countClick('red')"></div>
        <div id="yellow" class="light" onclick="countClick('yellow')"></div>
        <div id="green" class="light" onclick="countClick('green')"></div>
    </div>
    
    <div class="counter">
        Красный: <span id="red-counter">0</span> |
        Жёлтый: <span id="yellow-counter">0</span> |
        Зелёный: <span id="green-counter">0</span>
    </div>
    
    <button id="reset-btn" onclick="resetCounters()">Сбросить счетчики</button>

    <script>
        // Конфиг JSONBin.io (ЗАМЕНИТЕ на свои данные!)
        const BIN_ID = '67fd2dd18561e97a50ff5fc7';  // Пример: '65a1b1e2266cfc3fde83f102'
        const API_KEY = '$2a$10$eXSewbY5e.u8maglSs2dBej3VguVXx.9BKIqM0lFLWQsMBMAI4xjq'; // Пример: '$2a$10$xxxxxxxxxxxxxxxxxxxxxx'
        
        let counters = { red: 0, yellow: 0, green: 0 };

        // Загружаем данные при старте
        async function loadCounters() {
            try {
                const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
                    headers: { 'X-Master-Key': API_KEY }
                });
                const data = await response.json();
                counters = data.record || { red: 0, yellow: 0, green: 0 };
                updateUI();
            } catch (error) {
                console.error('Ошибка загрузки:', error);
            }
        }

        // Обновляем счетчики на сервере
        async function saveCounters() {
            try {
                await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
                    method: 'PUT',
                    headers: { 
                        'Content-Type': 'application/json',
                        'X-Master-Key': API_KEY 
                    },
                    body: JSON.stringify(counters)
                });
            } catch (error) {
                console.error('Ошибка сохранения:', error);
            }
        }

        // Клик по цвету
        async function countClick(color) {
            counters[color]++;
            updateUI();
            await saveCounters();
            
            // Анимация
            const light = document.getElementById(color);
            light.style.transform = 'scale(0.9)';
            setTimeout(() => { light.style.transform = 'scale(1)'; }, 200);
        }

        // Сброс
        async function resetCounters() {
            counters = { red: 0, yellow: 0, green: 0 };
            updateUI();
            await saveCounters();
        }

        // Обновление интерфейса
        function updateUI() {
            document.getElementById('red-counter').textContent = counters.red;
            document.getElementById('yellow-counter').textContent = counters.yellow;
            document.getElementById('green-counter').textContent = counters.green;
        }

        // Запускаем при загрузке
        loadCounters();
    </script>
</body>
</html>